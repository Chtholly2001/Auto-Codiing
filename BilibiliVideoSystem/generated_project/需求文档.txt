--- è¯Šæ–­ç»“æœ ---

åŸºäºå¯¹æ‚¨é¡¹ç›®çš„å…¨é¢åˆ†æï¼Œæˆ‘å‘ç°è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½ç›¸å¯¹å®Œæ•´çš„Bç«™è§†é¢‘é¢„è§ˆå¹³å°ã€‚è™½ç„¶æ ¸å¿ƒåŠŸèƒ½å·²ç»å®ç°ï¼Œä½†ä»æœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›å’Œå¢å¼ºçš„åœ°æ–¹ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„è¯Šæ–­å’Œæ”¹è¿›å»ºè®®ï¼š

## é¡¹ç›®ç°çŠ¶åˆ†æ

æ‚¨çš„é¡¹ç›®ç›®å‰å…·å¤‡ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š
- âœ… è§†é¢‘æ•°æ®ç®¡ç†ï¼ˆå¢åˆ æŸ¥ï¼‰
- âœ… JSONæ–‡ä»¶æŒä¹…åŒ–å­˜å‚¨
- âœ… å“åº”å¼å‰ç«¯ç•Œé¢
- âœ… è¡¨å•éªŒè¯å’Œé”™è¯¯å¤„ç†
- âœ… åŸºæœ¬çš„ç”¨æˆ·äº¤äº’

## æŒ‰æ–‡ä»¶åˆ†ç±»çš„æ”¹è¿›å»ºè®®

### **app.py - åç«¯åŠŸèƒ½å¢å¼º**

**1. æ•°æ®éªŒè¯å’Œå®‰å…¨æ€§æ”¹è¿›**
```python
# å»ºè®®æ·»åŠ æ›´ä¸¥æ ¼çš„URLéªŒè¯
def validate_bilibili_url(url):
    """æ›´ä¸¥æ ¼çš„Bç«™URLéªŒè¯"""
    import re
    pattern = r'^https?://(www\.)?bilibili\.com/video/(BV[0-9A-Za-z]+|av[0-9]+)'
    return bool(re.match(pattern, url))

# åœ¨validate_video_dataä¸­è°ƒç”¨
def validate_video_data(video_data):
    if not isinstance(video_data, dict):
        return False

    required_fields = ['title', 'bilibili_url']
    for field in required_fields:
        if field not in video_data or not str(video_data[field]).strip():
            return False

    # ä½¿ç”¨æ›´ä¸¥æ ¼çš„URLéªŒè¯
    if not validate_bilibili_url(video_data.get('bilibili_url', '')):
        return False

    return True
```

**2. æ·»åŠ è§†é¢‘ç¼–è¾‘åŠŸèƒ½**
```python
@app.route('/api/update_video/<int:video_id>', methods=['PUT'])
def update_video(video_id):
    """æ›´æ–°è§†é¢‘ä¿¡æ¯"""
    try:
        update_data = request.get_json()
        videos_data = load_videos_data()

        for i, video in enumerate(videos_data):
            if video.get('id') == video_id:
                # ä¿ç•™åŸå§‹IDï¼Œåªæ›´æ–°å…¶ä»–å­—æ®µ
                for key, value in update_data.items():
                    if key != 'id' and key in video:
                        videos_data[i][key] = value

                if save_videos_data(videos_data):
                    return jsonify({"message": "è§†é¢‘æ›´æ–°æˆåŠŸ", "video": videos_data[i]})
                else:
                    return jsonify({"error": "ä¿å­˜å¤±è´¥"}), 500

        return jsonify({"error": "è§†é¢‘ä¸å­˜åœ¨"}), 404

    except Exception as e:
        app.logger.error(f"æ›´æ–°è§†é¢‘å¤±è´¥: {str(e)}")
        return jsonify({"error": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"}), 500
```

**3. æ·»åŠ æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½**
```python
@app.route('/api/search_videos')
def search_videos():
    """æœç´¢è§†é¢‘"""
    query = request.args.get('q', '').lower().strip()
    if not query:
        return jsonify([])

    videos_data = load_videos_data()
    results = []

    for video in videos_data:
        # åœ¨æ ‡é¢˜ã€UPä¸»ã€æè¿°ä¸­æœç´¢
        if (query in video.get('title', '').lower() or
            query in video.get('up_name', '').lower() or
            query in video.get('description', '').lower()):
            results.append(video)

    return jsonify(results)
```

### **static/js/main.js - å‰ç«¯äº¤äº’å¢å¼º**

**1. æ·»åŠ å®æ—¶æœç´¢åŠŸèƒ½**
```javascript
// åœ¨main.jsä¸­æ·»åŠ æœç´¢åŠŸèƒ½
function initSearch() {
    const searchInput = document.createElement('input');
    searchInput.type = 'text';
    searchInput.placeholder = 'æœç´¢è§†é¢‘æ ‡é¢˜ã€UPä¸»æˆ–æè¿°...';
    searchInput.className = 'search-input';

    // æ·»åŠ åˆ°é¡µé¢é€‚å½“ä½ç½®
    const header = document.querySelector('.page-header');
    if (header) {
        header.appendChild(searchInput);

        // å®æ—¶æœç´¢
        searchInput.addEventListener('input', debounce(function(e) {
            const query = e.target.value.trim();
            if (query.length >= 2) {
                searchVideos(query);
            } else if (query.length === 0) {
                resetVideoList();
            }
        }, 300));
    }
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}
```

**2. æ·»åŠ è§†é¢‘ç¼–è¾‘ç•Œé¢**
```javascript
function initEditFunctionality() {
    // ä¸ºæ¯ä¸ªè§†é¢‘å¡ç‰‡æ·»åŠ ç¼–è¾‘æŒ‰é’®
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('edit-btn')) {
            const videoId = e.target.dataset.videoId;
            openEditModal(videoId);
        }
    });
}

function openEditModal(videoId) {
    // åˆ›å»ºç¼–è¾‘æ¨¡æ€æ¡†
    // åŠ è½½è§†é¢‘æ•°æ®å¹¶å¡«å……è¡¨å•
    // å¤„ç†æ›´æ–°è¯·æ±‚
}
```

### **templates/index.html - ç•Œé¢ä¼˜åŒ–**

**1. æ·»åŠ æœç´¢ç•Œé¢**
```html
<!-- åœ¨upload-sectionåé¢æ·»åŠ æœç´¢åŒºåŸŸ -->
<div class="search-section">
    <input type="text" id="searchInput" class="search-input"
           placeholder="ğŸ” æœç´¢è§†é¢‘æ ‡é¢˜ã€UPä¸»æˆ–æè¿°...">
    <div id="searchResults" class="search-results"></div>
</div>
```

**2. æ·»åŠ åˆ†ç±»ç­›é€‰**
```html
<div class="filter-section">
    <select id="sortSelect" class="filter-select">
        <option value="newest">æœ€æ–°å‘å¸ƒ</option>
        <option value="oldest">æœ€æ—©å‘å¸ƒ</option>
        <option value="play_high">æ’­æ”¾é‡ä»é«˜åˆ°ä½</option>
        <option value="play_low">æ’­æ”¾é‡ä»ä½åˆ°é«˜</option>
    </select>

    <button class="filter-btn" data-filter="all">å…¨éƒ¨</button>
    <button class="filter-btn" data-filter="recent">æœ€è¿‘ä¸€å‘¨</button>
    <button class="filter-btn" data-filter="popular">çƒ­é—¨è§†é¢‘</button>
</div>
```

### **static/css/style.css - æ ·å¼å¢å¼º**

**1. æ·»åŠ æ–°çš„æ ·å¼ç±»**
```css
/* æœç´¢å’Œç­›é€‰æ ·å¼ */
.search-section {
    margin: 20px auto;
    max-width: 600px;
}

.search-input {
    width: 100%;
    padding: 12px 20px;
    border: 2px solid #e1e5e9;
    border-radius: 25px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

.search-input:focus {
    outline: none;
    border-color: #00a1d6;
}

.filter-section {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin: 20px 0;
    flex-wrap: wrap;
}

.filter-select, .filter-btn {
    padding: 8px 16px;
    border: 2px solid #e1e5e9;
    border-radius: 6px;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
}

.filter-btn.active {
    background: #00a1d6;
    color: white;
    border-color: #00a1d6;
}

/* ç¼–è¾‘æŒ‰é’®æ ·å¼ */
.edit-btn {
    background: #ffa502;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    margin-left: 10px;
    transition: background 0.3s ease;
}

.edit-btn:hover {
    background: #e59400;
}
```

## é«˜çº§åŠŸèƒ½å»ºè®®

### **1. æ•°æ®ç»Ÿè®¡å’Œåˆ†æ**
- æ·»åŠ è§†é¢‘è§‚çœ‹è¶‹åŠ¿ç»Ÿè®¡
- UPä¸»å‘å¸ƒé¢‘ç‡åˆ†æ
- çƒ­é—¨æ ‡ç­¾äº‘

### **2. ç”¨æˆ·ç³»ç»Ÿ**
- ç”¨æˆ·æ³¨å†Œç™»å½•
- æ”¶è—å¤¹åŠŸèƒ½
- ä¸ªäººè§‚çœ‹å†å²

### **3. æ•°æ®å¯¼å…¥å¯¼å‡º**
- æ”¯æŒCSVæ‰¹é‡å¯¼å…¥
- æ•°æ®å¤‡ä»½åŠŸèƒ½
- æ¨¡æ¿ä¸‹è½½

### **4. æ€§èƒ½ä¼˜åŒ–**
- æ·»åŠ æ•°æ®åˆ†é¡µ
- å›¾ç‰‡æ‡’åŠ è½½
- å‰ç«¯ç¼“å­˜ç­–ç•¥

### **5. ç›‘æ§å’Œæ—¥å¿—**
- æ“ä½œæ—¥å¿—è®°å½•
- é”™è¯¯ç›‘æ§
- ç”¨æˆ·è¡Œä¸ºåˆ†æ

## å®æ–½ä¼˜å…ˆçº§å»ºè®®

**é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å®æ–½ï¼‰ï¼š**
1. æœç´¢åŠŸèƒ½
2. æ•°æ®æ’åºå’Œç­›é€‰
3. è§†é¢‘ç¼–è¾‘åŠŸèƒ½
4. æ›´ä¸¥æ ¼çš„æ•°æ®éªŒè¯

**ä¸­ä¼˜å…ˆçº§ï¼ˆåç»­ç‰ˆæœ¬ï¼‰ï¼š**
1. ç”¨æˆ·ç³»ç»Ÿ
2. æ•°æ®ç»Ÿè®¡
3. æ‰¹é‡æ“ä½œ

**ä½ä¼˜å…ˆçº§ï¼ˆé•¿æœŸè§„åˆ’ï¼‰ï¼š**
1. é«˜çº§åˆ†æåŠŸèƒ½
2. ç§»åŠ¨ç«¯APP
3. ç¬¬ä¸‰æ–¹é›†æˆ

è¿™äº›æ”¹è¿›å°†ä½¿æ‚¨çš„é¡¹ç›®ä»åŸºç¡€çš„æ•°æ®å±•ç¤ºå¹³å°å‡çº§ä¸ºåŠŸèƒ½å®Œæ•´çš„è§†é¢‘ç®¡ç†ç³»ç»Ÿï¼Œå¤§å¤§æå‡ç”¨æˆ·ä½“éªŒå’Œå®ç”¨æ€§ã€‚å»ºè®®å…ˆä»æœç´¢å’Œç¼–è¾‘åŠŸèƒ½å¼€å§‹ï¼Œè¿™äº›æ˜¯ç”¨æˆ·æœ€éœ€è¦çš„æ ¸å¿ƒå¢å¼ºåŠŸèƒ½ã€‚

--- è¯Šæ–­ç»“æŸ ---